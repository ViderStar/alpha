# Анализ кредитного риска заемщиков

Этот проект посвящен анализу кредитного риска заемщиков-физических лиц на основе предоставленных исторических данных. 

## Используемые данные

Данные представляют собой информацию о кредитополучателях, которые за исследуемый период ушли или не ушли в дефолт (то есть имеют активную просроченную задолженность). 

Датасет содержит следующие признаки:

- Целевой признак - дефолт клиента (MARKER): 1 - по клиенту был зафиксирован дефолт на момент сбора данных, 0 - по клиенту не был зафиксирован дефолт на момент сбора данных.

- Признаки A-X - зашифрованные характеристики кредитополучателей.

Данные разделены на две выборки:

- train - для обучения модели 
- test - для итоговой оценки модели

## Подготовка данных

Проведен первичный анализ данных (EDA):

- Датасет сильно несбалансирован - количество классов "0" значительно превышает количество классов "1" 

- В датасете отсутствуют пропущенные значения

- Числовые и категориальные признаки преобразованы в числовой формат

Для балансировки классов применен метод SMOTE. 

## Модели машинного обучения

Были протестированы следующие модели:

- Логистическая регрессия
- Случайный лес
- XGBoost

Логистическая регрессия была выбрана, потому что часто показывает лучшие результаты для задач бинарной классификации. Кроме того, она хорошо работает на несбалансированных данных после применения методов ресэмплинга.

Случайный лес и XGBoost - популярные алгоритмы бустинга, которые также часто используются для задач кредитного скоринга.

Для всех моделей проводилась оптимизация гиперпараметров с использованием кросс-валидации.

## Результаты

Лучшие результаты показала логистическая регрессия, превзойдя случайный лес и XGBoost по метрикам ROC AUC, точности, полноте и F1.

### В первом случае логистическая регрессия была обучена с default параметрами (макс. кол-во итераций 1000). Ее качество на тесте:

- Accuracy: 0.85
- Recall: 0.84
- F1-score: 0.84

### Во втором случае для логистической регрессии проводился поиск оптимальных гиперпараметров с помощью кросс-валидации GridSearchCV. Эта модель показала на тесте следующие результаты:

- ROC AUC: 0.750
- Accuracy: 0.750
- Recall: 0.768

### RandomForest:

- ROC AUC: 0.584
- Accuracy: 0.979
- Precision: 0.038
- Recall: 0.186

Случайный лес показал очень низкое качество по метрикам ROC AUC, точности и полноте. Вероятно, этому алгоритму не удалось эффективно справиться с сильным дисбалансом классов в данных.

### XGBoost:

- ROC AUC: 0.620
- Accuracy: 0.679
- Precision: 0.006
- Recall: 0.559

XGBoost продемонстрировал более высокое качество по сравнению со случайным лесом, но уступил логистической регрессии. Возможно, стоит попробовать другие способы балансировки классов и более тщательную настройку гиперпараметров для этого алгоритма.

## Выводы

Логистическая регрессия оказалась лучшей моделью для прогнозирования кредитного риска на данных. Это может быть связано с её способностью лучше обрабатывать несбалансированные данные после применения методов ресэмплинга.

Для дальнейшего улучшения результатов можно попробовать другие методы борьбы с несбалансированностью данных, такие как взвешивание классов. Также имеет смысл потратить больше времени на более тщательную настройку гиперпараметров уже написанных моделей.